{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "colorpicker-field",
  "type": "registry:component",
  "title": "ColorPickerField",
  "description": "A component for Wandry UI",
  "dependencies": [
    "@wandry/inertia-form",
    "react-aria-components"
  ],
  "registryDependencies": [
    "field",
    "button",
    "input-group",
    "popover"
  ],
  "files": [
    {
      "path": "registry/wandry-ui/colorpicker-field.tsx",
      "content": "\"use client\";\nimport * as React from \"react\";\nimport { Pipette } from \"lucide-react\";\nimport { useField } from \"@wandry/inertia-form\";\n\nimport {\n  Field,\n  FieldDescription,\n  FieldError,\n  FieldLabel,\n} from \"@/components/ui/field\";\n\nimport type {\n  ColorAreaProps,\n  ColorFormat,\n  ColorPickerProps as ColorPickerPrimitiveProps,\n  ColorSliderProps,\n  ColorSwatchProps,\n  ColorThumbProps,\n  SliderOutputProps,\n  SliderTrackProps,\n} from \"react-aria-components\";\nimport {\n  ColorThumb as ColorThumbPrimitive,\n  ColorArea as ColorAreaPrimitive,\n  ColorSlider as ColorSliderPrimitive,\n  ColorPicker as ColorPickerPrimitive,\n  ColorSwatch as ColorSwatchPrimitive,\n  SliderOutput as SliderOutputPrimitive,\n  SliderTrack as SliderTrackPrimitive,\n  ColorPickerStateContext,\n  parseColor,\n} from \"react-aria-components\";\nimport { cn } from \"@/lib/utils\";\nimport {\n  InputGroup,\n  InputGroupAddon,\n  InputGroupInput,\n} from \"@/components/ui/input-group\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\n\nexport type ColorFieldProps = {\n  name: string;\n  label?: string;\n  description?: string;\n  placeholder?: string;\n  format?: ColorFormat | \"css\";\n  defaultValue?: string;\n};\n\ninterface ColorPickerProps extends ColorPickerPrimitiveProps {\n  className?: string;\n}\n\ndeclare global {\n  interface Window {\n    EyeDropper?: new () => { open: () => Promise<{ sRGBHex: string }> };\n  }\n}\n\nconst ColorPickerField: React.FC<ColorFieldProps> = ({\n  name,\n  label,\n  description,\n  defaultValue = \"#FFFFFF\",\n  format = \"hex\",\n}) => {\n  const field = useField(name, { defaultValue });\n\n  const onColorInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    field.onChange(value);\n  };\n\n  return (\n    <Field>\n      <FieldLabel>{label}</FieldLabel>\n      <InputGroup>\n        <InputGroupInput value={field.value} onChange={onColorInputChange} />\n        <InputGroupAddon align=\"inline-end\" className=\"pr-2\">\n          <ColorPicker\n            value={field.value}\n            onChange={(color) => field.onChange(color.toString(format))}\n          >\n            <Popover modal>\n              <PopoverTrigger asChild>\n                <ColorSwatch className=\"cursor-pointer\" />\n              </PopoverTrigger>\n              <PopoverContent className=\"p-1 max-w-full w-full\">\n                <ColorArea\n                  colorSpace=\"rgb\"\n                  defaultValue={defaultValue}\n                  xChannel=\"red\"\n                  yChannel=\"green\"\n                  xName=\"red\"\n                  yName=\"green\"\n                />\n              </PopoverContent>\n            </Popover>\n          </ColorPicker>\n        </InputGroupAddon>\n      </InputGroup>\n      <FieldDescription>{description}</FieldDescription>\n      <FieldError>{field.error}</FieldError>\n    </Field>\n  );\n};\n\nexport function ColorArea({ className, ...props }: ColorAreaProps) {\n  return (\n    <ColorAreaPrimitive\n      {...props}\n      data-slot=\"color-area\"\n      className={cn(\n        \"w-full size-56 shrink-0 rounded-sm bg-muted disabled:bg-muted-fg\",\n        className\n      )}\n      style={({ defaultStyle, isDisabled }) => ({\n        ...defaultStyle,\n        background: isDisabled ? undefined : defaultStyle.background,\n      })}\n    >\n      <ColorThumb />\n    </ColorAreaPrimitive>\n  );\n}\n\nexport function ColorThumb({ className, ...props }: ColorThumbProps) {\n  return (\n    <ColorThumbPrimitive\n      {...props}\n      style={({ defaultStyle, isDisabled }) => ({\n        ...defaultStyle,\n        backgroundColor: isDisabled ? undefined : defaultStyle.backgroundColor,\n      })}\n      className={cn(\n        \"top-[50%] left-[50%] size-6 rounded-full border-2 border-white [box-shadow:0_0_0_1px_black,_inset_0_0_0_1px_black]\",\n        \"focus-visible:size-8\",\n        \"dragging:bg-muted-fg dragging:forced-colors:bg-[ButtonBorder]\",\n        \"disabled:opacity-50 disabled:forced-colors:border-[GrayText] disabled:forced-colors:bg-[GrayText]\",\n        className\n      )}\n    />\n  );\n}\n\nexport function ColorSlider({ className, ...props }: ColorSliderProps) {\n  return (\n    <ColorSliderPrimitive\n      data-slot=\"control\"\n      className={cn(\n        \"orientation-vertical:flex orientation-horizontal:grid orientation-horizontal:w-full grid-cols-[1fr_auto] flex-col items-center gap-2\",\n        className\n      )}\n      {...props}\n    />\n  );\n}\n\nexport function ColorSliderOutput({ className, ...props }: SliderOutputProps) {\n  return (\n    <SliderOutputPrimitive\n      className={cn(\n        \"orientation-vertical:hidden font-medium text-base/6 sm:text-sm/6\",\n        className\n      )}\n      {...props}\n    />\n  );\n}\n\nexport function ColorSliderTrack({ className, ...props }: SliderTrackProps) {\n  return (\n    <SliderTrackPrimitive\n      className={cn(\n        \"group col-span-2 orientation-horizontal:h-6 rounded-lg\",\n        \"orientation-horizontal:h-6 orientation-horizontal:w-full\",\n        \"orientation-vertical:-translate-x-[50%] orientation-vertical:ml-[50%] orientation-vertical:h-56 orientation-vertical:w-6\",\n        \"bg-muted-fg disabled:opacity-50 forced-colors:bg-[GrayText]\",\n        className\n      )}\n      {...props}\n      style={({ defaultStyle, isDisabled }) => ({\n        ...defaultStyle,\n        background: isDisabled\n          ? undefined\n          : `${defaultStyle.background}, repeating-conic-gradient(#CCC 0% 25%, white 0% 50%) 50% / 16px 16px`,\n      })}\n    />\n  );\n}\n\nconst ColorPicker = ({ className, ...props }: ColorPickerProps) => {\n  return (\n    <div data-slot=\"control\" className={className}>\n      <ColorPickerPrimitive {...props} />\n    </div>\n  );\n};\n\nconst EyeDropper = () => {\n  const state = React.use(ColorPickerStateContext)!;\n\n  if (!window.EyeDropper) {\n    return \"EyeDropper is not supported in your browser.\";\n  }\n\n  return (\n    <Button\n      className=\"shrink-0\"\n      aria-label=\"Eye dropper\"\n      size=\"icon\"\n      onClick={() => {\n        const eyeDropper = window.EyeDropper ? new window.EyeDropper() : null;\n        eyeDropper\n          ?.open()\n          .then((result) => state.setColor(parseColor(result.sRGBHex)));\n      }}\n    >\n      <Pipette />\n    </Button>\n  );\n};\n\nexport function ColorSwatch({ className, ...props }: ColorSwatchProps) {\n  return (\n    <ColorSwatchPrimitive\n      data-slot=\"color-swatch\"\n      className={cn(\n        \"size-5 inset-ring-1 inset-ring-current/20 shrink-0 rounded-[calc(var(--radius-sm)-1px)]\",\n        className\n      )}\n      {...props}\n    />\n  );\n}\n\nexport default ColorPickerField;\n",
      "type": "registry:component"
    }
  ]
}